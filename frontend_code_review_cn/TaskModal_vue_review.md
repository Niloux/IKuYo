# `frontend/src/components/TaskModal.vue` 代码审查

## 分析

`TaskModal.vue` 组件是一个模态框，用于创建新的爬虫任务。它提供了一个表单，允许用户选择任务模式（首页、季度、年份）、年份、季度和限制数量。

1.  **Props 定义**: 接收 `visible`（控制模态框显示）、`task`（表单数据）、`errors`（验证错误信息）、`onSubmit`（提交回调）、`onCancel`（取消回调）和 `onUpdateTask`（更新表单数据回调）。
2.  **表单**: 使用 `<form>` 元素构建表单，并通过 `v-model` 绑定到 `task` prop。表单字段根据选择的模式动态显示。
3.  **动态年份**: `availableYears` 计算属性动态生成从 2013 年到当前年份的列表，用于年份选择器。
4.  **错误显示**: 根据 `errors` prop 的内容，显示相应的验证错误信息。
5.  **样式**: 样式通过 `style src="../assets/task.css"` 外部引入。

## 建议和理由

### 1. 表单数据管理

*   **建议**: 当前组件通过 `task` prop 接收表单数据，并通过 `onUpdateTask` 事件将数据回传给父组件。这种模式（`v-model` 的手动实现）是可行的，但对于复杂表单，可能会导致父组件的逻辑变得复杂。
*   **理由**: 考虑使用 Vue 3 的 `v-model` 语法糖来简化表单数据的双向绑定。例如，可以将 `task` prop 命名为 `modelValue`，并发出 `update:modelValue` 事件。这样，父组件可以直接使用 `v-model="newTask"` 来绑定数据，使代码更简洁。

### 2. 表单验证的职责划分

*   **建议**: 当前组件只负责显示错误信息，而实际的表单验证逻辑（`validateCreateTaskForm`）在父组件 `TaskManagementView.vue` 中。这使得表单组件不够独立。
*   **理由**: 建议将表单验证逻辑封装到 `TaskModal.vue` 组件内部。这样可以使表单组件更加自包含和可复用。组件可以在内部执行验证，并通过事件（例如 `submit` 事件中包含验证结果）通知父组件。或者，可以考虑使用表单验证库来简化验证逻辑。

### 3. 季度选项的硬编码

*   **建议**: 季度选项（春、夏、秋、冬）是硬编码在模板中的 `<option>` 标签。如果未来需要支持其他语言或更灵活的季度定义，需要修改代码。
*   **理由**: 考虑将季度选项定义为一个数组或枚举，并在模板中通过 `v-for` 渲染。这样可以提高可维护性，并方便未来的国际化。

### 4. 模式选择的默认值

*   **建议**: `task.mode` 的默认值是 `homepage`。在表单中，`select` 元素的第一个选项是“请选择模式”，其 `value` 为空字符串。如果用户不选择，可能会导致验证错误。
*   **理由**: 确保 `select` 元素的默认值与 `task.mode` 的初始值一致，或者在验证逻辑中明确处理“未选择”的情况。

### 5. 样式引入方式

*   **建议**: 样式通过 `style src="../assets/task.css"` 外部引入。这种方式在 Vue SFC 中是有效的，但如果 `task.css` 包含了大量通用样式，可能会导致样式冲突或难以追踪。
*   **理由**: 确保 `task.css` 中的样式是模块化的，并且只包含与任务相关的通用样式。对于组件特有的样式，建议直接写在 `<style scoped>` 块中，以避免全局污染。

### 6. 可访问性 (Accessibility)

*   **建议**: 确保表单字段都有明确的 `label` 标签，并且 `input` 和 `select` 元素通过 `id` 与 `label` 关联。这有助于屏幕阅读器用户理解表单结构。
*   **理由**: 当前代码已经使用了 `label` 和 `for` 属性，这是很好的实践，保持这种可访问性。

### 7. `limit` 字段的验证提示

*   **建议**: `limit` 字段的错误提示是“请输入正整数或留空”。这很清晰。
*   **理由**: 保持这种清晰的用户反馈。

### 总结

`TaskModal.vue` 组件提供了创建爬虫任务的表单功能。主要的改进点在于优化表单数据管理和验证的职责划分，将季度选项进行配置化，以提高组件的独立性、用户体验和可维护性。
